apiVersion: "superdns.io/v1"
kind: Route
metadata:
  name: example.app.com
  namespace: superdns
spec:
  enableScript: true
  scriptContent: |
    -- www.superdns.com
    if MatchFuncs == nil then
    	MatchFuncs = {}
    end
    
    MatchFuncs["example.app.com"] = function(tags, clusters)
    	-- 仿真环境路由匹配规则
    	if tags["Environment"] == "sim" then
    		target = tags["X-Lane-Cluster"] -- 泳道集群
    		cluster = clusters[target]
    		if cluster ~= nil then
    			return { {cluster.Name, 1} }
    		end
    
    		cluster = clusters["hna-sim000-v"] -- 基准集群
    		if cluster ~= nil then
    			return { {cluster.Name, 1} }
    		end
    	end
    
    	return { {"hna", 1} }
    end
  defaultDestinations:
  - cluster: "hna-v"
    percent: 1
